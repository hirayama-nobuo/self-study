# Linux(第1章)  

## UNIXとLinux  
LinuxはPC上で利用可能なUNIX互換のOS。  
無料で配布されており、使用することができる。  
LinuxはUNIXと同じ動作をするプログラムをUNIXのソースコードを使わず、ゼロから記述し作り上げたもの。  

## ディストリビューション
LinuxのOSとしての中心となる機能をカーネルという。  
カーネルの実現のために、デバイスドライバやツール等のインストールが必要になる。  
Linuxの導入ではLinuxカーネルと関連ソフトウェアが必要になるが、パッケージ化して流通させる形態をディストリビューションという。  
現在の主なディストリビューションは以下。 
- Debian GNU/Linux   
- Ubuntu
- Red Hat Enterprise Linux  
- Fedora  
- CentOS  
Debian系、Red Hat系、Slackware系などに分類される。  
現在ではディストリビューションの多くはネット上で無償で公開されている。  

## UNIXの基本知識  
- マルチユーザーシステム  
  複数のユーザで同時にOSを使用することができる。  
- スーパーユーザ・一般ユーザ  
  ユーザ間でセキュリティ問題が発生しないように管理をスーパユーザが行う。  
  rootというユーザ名を使うため「rootユーザ」とも呼ばれる。  
  その他のユーザは一般ユーザと呼ばれる。  
  スーパユーザがアカウント登録を行う。  
- 大文字と小文字  
  UNIXでは大文字と小文字が区別される。  
  UNIXコマンドは基本的に小文字で入力するため、特に意図のない場合は小文字を使用するのが一般的。  
- ドットファイル
  先頭が「.」で始まるファイル。  
  ドットファイルは隠しファイルであり、通常画面に表示されない。  
- コマンド引数にディレクトリを指定  
  コマンド実行の引数としてディレクトリ名を入力するとき、ディレクトリ名の後ろに「/」をつける。  
  ```
  ls mydir/ mydir　ディレクトリの内容を見る  
  cp myfile mydir/　myfileをmydirディレクトリにコピー
  ```
- コマンド実行の中断  
  コマンド実行時にcontrol＋Cを押下することでコマンドの実行を中断することが可能。  

# テキストログイン(第2章)  

## ログインする  
ログインが正しく行われるとユーザはUNIX上で作業が可能になる。  
作業後ログアウトの手続きを行い、UNIXとの関係を絶つ。  
個人使用のUNIX環境ではログインした状態からそのままログアウトすることが可能。  
スーパーユーザは通常suという特別なログイン名を持っているため、スーパーユーザのことをrootユーザと呼ぶこともある。  
rootでログインしたスーパユーザはシステム管理を行うことが主業務であり、rootユーザでログインすると重要なファイルも削除が可能。  
一般ユーザ名でログインすると重要ファイルの削除権限がないため、削除してしまう危険はない。  

## ログアウトする  
作業が完了した時点でログアウトを行う。  
ログアウトはログインしたユーザが作業を終了する宣言であり、UNIXシステム全体の終了を意味するものではない。  

## システムの終了と再起動  
ログアウトしてもUNIXシステムは動いているため、電源を落としてもいい状態にするためシャットダウンを行う。  
内部的に起動しているプログラムが正しい順番で停止される。  
基本的に一般ユーザでもシャットダウンできるようになっているが、その場合は一度スーパーユーザになった上でシャットダウンを行う。  
シャットダウンのコマンド実行が完了した時点で電源を落とすことができる。  
UNIXシステムの設定を変更したり具合が悪くなった場合はシステムの再起動(リブート)を行うことがある。  

## ホスト名の変更
ホスト名はLinuxインストール時に指定する。  
ホスト名はネットワークでマシンを特定するために設定する。  
ホスト名はシステム起動時に設定され基本的には変更するものではない。  
現在のホスト名の表示にはhostnameコマンドを使用する。  
変更はスーパーユーザのみが可能。  

# 仮想コンソール(第3章)  

## 仮想コンソール  
Linuxでは1台のPCで6組みのコンソールセット(ディスプレイとキーボード)をつなぐことが可能。  
通常は1つしかないため、仮想コンソールの機能を用意する。  
whoコマンドを使用することで誰がどの仮想コンソールを使用しているかを調べることが可能。  

# ファイルとディレクトリ(第4章)  

## ファイルの作成  
エディタを起動することなく簡易的にファイルを作成することが可能。  
ファイル作成のコマンドには「echo」「cat」「touch」コマンドが使用される。 

## ワイルドカード  
複数のファイルを指定するときに、ワイルドカードと呼ばれる特殊記号を使用する。  
|  記号  |  説明  |
| ---- | ---- |
|  *  |  任意の文字列  |
|  ?  |  任意の1文字  |
|  [...]  |  []内に含まれる任意の1文字  |
|  [!...]  |  []内に含まれない任意の1文字  |
|  {~}  |  {}内に含まれる任意の文字列  |  

ドットファイルにおいてワイルドカードを使用する場合は例外処理をする。    
ドットファイルは明確に指定をしない限り処理をしないルールとなっている。  
|  記号  |  説明  |
| ---- | ---- |
|  .*  |  先頭が.で始まる全ファイル  |
|  ＊{.ab}*  |  .abのどれかを含むファイル (例)myfile.txt  |  

## ファイル名のルール  
ファイル名の長さの上限は255バイト。   
一般記号をファイル名に使用可能。(使用可能だが特殊記号とぶつかる場合がある)  
ファイル名を""で囲むことにより、ファイル名に空白を入れることが可能。(可能ではあるが使用しないのが一般的)  

## ファイル名・ディレクトリ名・パス名  
UNIXではディレクトリに分けてファイル管理を行う。  
ディレクトリは複数の部屋があり、その部屋の一つというイメージ。  
複数の部屋でファイルを分類して格納する。  
UNIXのディレクトリは階層構造であり、その頂点のディレクトリをルートディレクトリと呼ぶ。  
「/」の記号でルートディレクトリを表す。  
ユーザが作業中のディレクトリをカレントディレクトリと呼ぶ。  
ユーザがログインしたとき、最初に位置するディレクトリをホームディレクトリと呼ぶ。  
ディレクトリの位置を示す方法は絶対指定と相対指定の2パターンが存在する。  
- 絶対指定  
  ルートディレクトリを基点にパスを指定する。  
  絶対指定で表現されたパスを絶対パスという。  
- 相対指定  
  カレントディレクトリを基点にパスを指定する。  
UNIXはコマンドを実行するときに、PATHという環境変数に登録されたパス情報から実行可能ファイルを探す。  
コマンド検索用のパスを設定することを「パスを通す」と表現する。  
以下のコマンドで通したパスを確認ができる。  
```
echo $PATH
```
ディレクトリを表す特殊記号が存在する。 
|  記号  |  説明  |
| ---- | ---- |
|  /  |  ルートディレクトリ  |
|  .  |  カレントディレクトリ  |
|  ..  |  親ディレクトリ(カレントディレクトリの一つ上のディレクトリ)  |
|  ~  |  ホームディレクトリ  |
|  ~-  |  直前にいたディレクトリ  | 
|  -ユーザ名  |  指定したユーザのホームディレクトリ  |   

# ファイルの操作(第5章)  

## 各ファイル操作の方法  
- ファイル内容を表示する  
  catコマンドを使用する。  
  ファイルは複数指定可能。  
  複数ファイルを指定しリダイレクトを行うことで、ファイル連結が可能。  
- ファイルの種類を調べる  
  fileコマンドを使用する。  
  あるファイルがどのようなファイルなのかを確認する。  
  fileコマンドはファイルの先頭部分だけを見て推測するため、誤る場合もあるが実用上は十分な精度である。  
- ファイルをコピーする  
  cpコマンドを使用する    
  転送先がディレクトリの場合、ファイル名にワイルドカードを使用することが可能。  
  ファイルをコピーするとコピー後のファイルのタイムスタンプはコピー実行後の日時情報に変更される。  
  -pオプションを使うことにより、元のファイルのタイムスタンプのままコピーされる。  
  また、スーパーユーザの場合、-pオプションを使うことでオーナー情報やグループ情報を維持したままコピーすることができる。  
  -rオプションを使うことで、ディレクトリを丸ごとコピーができる。  
- ファイル移動・名前変更  
  mvコマンドを使用する  
  転送先がディレクトリの場合、ファイル名にワイルドカードを使用することが可能。  
  ファイル名だけを二つ書き並べた場合はファイル名の変更となる。  
  ファイル名の変更の際にはワイルドカードを使用することはできない。  
- ファイルを削除する  
  rmコマンドを使用する。  
- ファイルを削除不可にする  
  ファイルを削除できなくするためには、そのファイルが属するディレクトリを書き込み禁止にすることで実現が可能。  
  書き込み可能ディレクトリ内の書き込み禁止ファイルは削除可能。  
  書き込み禁止ディレクトリ内の書き込み可能ファイルは削除不可。  
  chmod -wコマンドで書き込み禁止にしたいディレクトリを指定し、実現する。  
- ファイルの日付を変更する  
  touchコマンドを使用する。  
  時刻情報を変更したいファイル名を指定する。  
  現在の時刻に修正したい場合はオプションは使用せず、指定時刻にしたい場合は-tコマンドを使い指定日時を入力する。  
  タイムスタンプに依存するプログラムへの対応等のため、時刻情報を変更する必要が発生する。  
- 現在日時を表示する  
  dateコマンドを使用する。  
  
## ファイルの探し方  
findコマンドを使用する。  
```
find 基点ディレクトリ 検索条件 アクション  
```
基点ディレクトリをルートで指定するとディスク全体を検索するので時間がかかる。  
ある程度絞り込んだ基点ディレクトリを指定した方が効率的。  
一般ユーザの場合はルートを基点とするとアクセス権のないディレクトリとなることがある。  
findコマンドでファイル名にワイルドカードを使用する場合、""で囲む。  
ファイルを更新した日付で検索する場合、-mtimeオプションを使用する。  
ファイルをデータサイズで検索する場合、-sizeオプションを使用する。  
その他非常に多くの検索方法があるため、必要に応じて「man find」コマンドを使用し、確認する。  

ファイル検索は指定するディレクトリによっては時間がかかったり、権限がなかったりする。  
その場合、あらかじめ全データをまとめたデータベースを作成し、locateコマンドを使用して検索を行う。  
権限がないディレクトリに出会い、検索できないトラブルが発生しない。  
locateコマンドで用いるデータベースはcron機能を使用し、自動更新される。  
手動で更新をする場合は以下のコマンドを実行する。  
```
updatedb &
```

# ディレクトリの操作(第6章)  

## ディレクトリの内容の表示  
ディレクトリの内容表示にはlsコマンドを使用する。  
ファイル名、ファイル種別、パーミッション等の情報、隠しファイルの情報を確認できる。  
lsコマンドには多くのオプションがあるため、必要に応じて「man ls」コマンドを使用し、確認する。  
ディレクトリを指定する場合、以下のどちらの方法でも問題ない。  
```
ls mydir  
ls mydir/  
```
lsコマンドで-Fオプションをつけると、ファイル名の後ろに1文字のファイルタイプをつけて表示する。  
|  記号  |  説明  |
| ---- | ---- |
|  なし |  通常ファイル  |
|  *  |  実行可能ファイル  |
|  @  | シンボリックリンク |
|  /  |  ディレクトリ |  

## ディレクトリ作成・削除  
ディレクトリの新規作成にはmkdirコマンドを使用する。  
ディレクトリにデフォルト以外のアクセス権を指定する場合はmkdir実行後に-mオプションを使用し、アクセス権を設定する。  
ディレクトリの削除はrmdirコマンドを使用する。  
rmdirコマンドは空のディレクトリでのみ使用可能で、ディレクトリ内にファイルやサブディレクトリがある場合は、先に削除をしてからrmdirコマンドを使用する。  
空でないディレクトリを削除する場合は、「rm -r」コマンドを使用する。  

## ディレクトリ移動  
mvコマンドを使用すると、ディレクトリの移動または名前の変更が可能。  
ディレクトリを移動させる場合は以下のコマンドを実行する。  
```
mv ディレクトリ名1 ディレクトリ名2
```
ディレクトリ1をディレクトリ2の名前に変更する、ディレクトリ1をディレクトリ2の下に丸ごと移動するという実行結果となる。  

作業中のカレントディレクトリを調べる場合、pwdコマンドを実行する。  
カレントディレクトリに移動するためにはcdコマンドを使用する。  
|  コマンド  |  説明  |
| ---- | ---- |
|  cd.. |  ひとつ上のディレクトリに移動する  |
|  cd../dr1  |  ひとつ上のディレクトリのサブディレクトリdr1にうつる |
|  cd  | ホームディレクトリにうつる |
|  cd ~-  | 直前のディレクトリにうつる |   

一時的に別ディレクトリにうつる、元のディレクトリに戻ることがあらかじめ分かっている場合、pushdとpopdコマンドを使用する。  
pushdを実行すると現在のディレクトリ名をディレクトリスタックと呼ばれる領域に保存し、ディレクトリ移動をする。  
popdコマンドを実行すると、そのディレクトリスタックからディレクトリ情報を取り出して、そのディレクトリに移動する。  

## ディスク情報の確認  
ディスクの使用容量のサイズを調べる場合、duコマンドを使用する。  
ファイルやディレクトリ単位で使用領域のサイズが表示される。  
ディスクの空き容量を調べるときはdfコマンドを使用する。  
ファイルシステムごとの空き容量を調べる。  

# リンクとiノード(第7章)   

## リンクの設定  
lnコマンドを使用し、ファイルやディレクトリに別名をつけることが可能。  
別名をつける作業を「リンクを貼る」と表現する。  
ファイル名は2つ、実体は1つという状態になる。  
リンクには以下の2つの種類がある。  
- ハードリンク  
  file_aとfileは同じファイル実体を指す。  
- シンボリックリンク  
  file_aはfleを指す。fileはファイル実体を指す。  
  シンボリックリンクはディレクトリのリンクもできる。  
  シンボリックリンクは別のファイルシステム上のファイルともリンクできる。  

リンクが貼られていることは「ls -F」コマンドで確認が可能。  
シンボリックリンクマーク(->)やリンク数の表示で確認。  

## リンクのメカニズム  
リンクを貼るときは現在のファイル(本名)に対して、新しいファイル名(別名)をつける。  
ハードリンクでは両ファイルともファイル格納情報をそれぞれ自分でもつ。  
ハードリンクはいったん張られたあとは、本名・別名の違いがなくなる。(どちらも本名になる)  
シンボリックリンクの場合は、本名情報に依存した別名という形で、明確に本名・別名の関係が維持される。(本名を参照して実体を指す)  
通常のファイルはファイル名とファイル実体が1対1で対応しているため、リンク数が1と表現できる。  
ハードリンクを張ると、2つ(以上)のファイル名に関連づけられるためリンク数が2となる。(リンクカウント)  
リンク設定後、オリジナルファイル名を削除した場合、  
- ハードリンク  
  別名ファイル自身もファイル実体の情報を持っているので、別名ファイルが有効でファイル実体にアクセスできる。  
- シンボリックリンク  
  別名ファイルは本名ファイルを参照してファイル実体にアクセスしているため、ファイル実体へのアクセスでエラーとなる。  
リンク数が0になった場合、ファイル実体も削除される。  
オリジナルファイル名を削除後、再度同名のファイルを作成した場合、  
- ハードリンク  
  別名ファイルは何も影響を受けない。  
- シンボリックリンク  
  別名ファイルはオリジナルファイル名を参照するため、再度作られた場合リンク関係が復活する。  

## iノード  
UNIXではファイルをiノードという機能を使って管理する。  
ファイルを一つ作るとiノードと呼ばれる管理情報を一つ作成する。  
iノードには識別用の番号であるiナンバが付与される。  
ディレクトリはファイル名とiナンバの組のみで構成されている。  
あるファイルが指定された場合、ディレクトリをみて対応するiナンバを確認する。  
次にそのiナンバに対応するテーブルを参照する。(このテーブルがiノード)  
ファイルに関する情報はすべてiノードに記述されている。  
Linuxの標準ファイルシステムではiノードのブロック番号(ブロックアドレス)を12個指定することができる。  
iノードはブロック番号の間接指定ポインタ機能を持っている。  

## リンクとiノードの関係  
- ハードリンク  
  ハードリンクを張った場合、同じiナンバのファイルが複数できる。  
  どちらのファイルを指定しても同じiノードなので、同じファイル実体を指す。  
  一つのファイル名を削除してもファイル実体が削除される訳ではない。  
  ファイル実体とリンクが張られたすべてのファイル名が削除された時、ファイル実体が解放される。  
- シンボリックリンク  
  シンボリックリンクの場合、リンク数が増えることはない。  
  別名で作られたファイル実体の中身はリンク先のファイル名を指す文字列となる。  
  iノードの中にはファイルの種類はシンボリックリンクであるという情報が記憶される。  

# テキスト処理(第8章)

## ファイル表示  
ファイルの先頭部分を見る場合headコマンド、ファイルの最後部分を見る場合tailコマンドを使用する。  
ファイル内容をソートする場合、sortコマンドを使用する。  
ソートコマンドのオプションは「man sort」で確認する。  
uniqコマンドを使用することでファイルないの重複行を削除することができる。  
重複行の確認は隣接する行においてのみ行われるため、対象ファイルをあらかじめソートする必要がある。  
フィールド位置や文字位置を指定して重複行比較をすることも可能。  

## 文字列の置換  
文字を1文字単位で別文字に変換する時に、trコマンド使用する。  
空白文字・シェルで展開される文字などは""で囲む。  
```
tr set1 set2 (set1をset2に置換する)  
```
set1とset2は同じ文字数である必要がある。  
異なる場合、余った部分は無視される。  
特定の文字を削除したい時は、-dオプションを使用する。  
特定の同一文字を圧縮する場合、-sオプションを使用する。  

## テキスト表示  
長いテキストファイルをcatコマンドで表示すると最後の部分しか見ることができないため、moreコマンドまたはlessコマンドを使用する。  
moreコマンドを実行するとテキスト全体の何パーセントまで表示しているかを示す。  
最後の行まで表示が完了すると、自動的にmoreコマンドは終了する。  
lessコマンドはmoreコマンドの機能を強化させたコマンドで、moreコマンドよりもlessコマンドの方が使用される。  
lessコマンドでは最後の行まで表示されても自動的には終了せず、終了する場合はqを入力して自身で終了する必要がある。  
スクロールする行数を以下のコマンドで変更できる。  
```
less -15 myfile 15行ずつスクロールする
```
空白行が連続する場合、-sオプションを使用することで1つの空白行に圧縮することが可能。  
「=」を押下することで表示されているテキストの現在行を確認することができる。  
テキストの文字列検索は以下のコマンドで行うことが可能。  
```
/this 最終行方向にthisという文字列を探す
?this 先頭行方向にthisという文字列を探す
```
lessコマンドを拡張したコマンドにlvコマンドがある。  
lvコマンドはLinuxではデフォルトでインストールされていない場合がある。  
基本的にはlessコマンドと同様なコマンドであるが、文字列検索を行う時に正規表現を用いた検索をすることができる。  
UNIX内部のテキスト閲覧ではlessコマンドで十分であるが、JISコードを使ったファイルなどの閲覧時にlvコマンドを使った方が内容を簡単に表示でき、便利である。  

## 文字列検索  
ファイルの中から指定された文字列を検索しその行を出力させる場合、grepコマンドを使用する。  
最初の文字が”-"ではじまる文字を検索しようとすると、オプション指定とぶつかるため「-e」オプションを使用して検索する。  
各種詳細な検索方法は「man grep」でオプションを確認し、使用する。  
同じ文字列検索を複数回行う場合、検索文字列をファイルで指定すると便利に検索をすることができる。  
```
cat mylist 検索する文字列をmylistの中に入れる  
grep -f mylist myfile 
```
grepでは正規表現での文字列指定をすることができる。  
正規表現記号を確認し、検索条件に使用する。  

## ファイル内容の相違を調べる  
diffコマンドを使用することで、ふたつのファイルの内容の違いを調べることができる。  
ファイル名の代わりにディレクトリ名を指定することができる。  
結果はacd(Add,Change,Delete)で処理結果が表示される。  
出力結果が「3c4」の場合、最初のファイルの3行目と次のファイルの4行目に違いがあり、Change(文字列の置き換え)を行うと正しいものになるという意味になる。  

## テキストのエコー表示  
echoコマンドを使用することで、テキストをそのまま標準出力に表示することができる。  
シェル等でのメッセージ出力のためによく用いられる。  











